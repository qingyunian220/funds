<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>基金数据分析展示</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
        }
        
        #fund-data-container {
            display: flex;
            justify-content: space-between;
            gap: 20px;
        }
        
        .fund-container {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
            flex: 1;
            min-width: 200px;
        }
        
        /* 减少基金容器右侧间距 */
        .fund-container {
            margin-right: 5px;
        }

        .fund-container:last-child {
            margin-right: 0;
        }

        /* 减少基金容器之间的间距 */
        #fund-data-container {
            gap: 5px;
        }

        /* 减少基金头部内边距 */
        .fund-header {
            background-color: #3498db;
            color: white;
            padding: 8px 12px;
            font-size: 1.2em;
            font-weight: bold;
        }
        
        /* 减少基金内容内边距 */
        .fund-content {
            padding: 12px;
        }
        
        .section {
            margin-bottom: 25px;
        }
        
        .section-title {
            font-size: 1.1em;
            font-weight: bold;
            color: #2980b9;
            border-bottom: 2px solid #3498db;
            padding-bottom: 5px;
            margin-bottom: 8px;
        }
        
        /* 风格因子部分使用两列网格布局 */
        .style-factors {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 5px;
        }
        
        /* 减少因子卡片内边距 */
        .factor-card {
            background-color: #f8f9fa;
            border-radius: 5px;
            padding: 8px;
            text-align: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .factor-name {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        /* 在同一行显示因子值并垂直居中对齐 */
        .factor-values {
            display: inline-flex;
            align-items: center;
        }

        /* 调整因子值字体大小和间距 */
        .factor-value {
            font-size: 0.9em;
            margin: 0 4px;
        }
        
        .fund-value {
            color: #e74c3c;
        }
        
        .average-value {
            color: #3498db;
        }
        
        .stock-info {
            background-color: #f8f9fa;
            border-radius: 5px;
            padding: 15px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .heavy-stock-text {
            font-size: 1.1em;
            font-weight: bold;
            color: #27ae60;
            margin-bottom: 10px;
        }
        
        .percentage-bar {
            height: 20px;
            background-color: #ecf0f1;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 10px;
        }
        
        .percentage-fill {
            height: 100%;
            background: linear-gradient(90deg, #27ae60, #2ecc71);
            border-radius: 10px;
            text-align: right;
            line-height: 20px;
            color: white;
            font-size: 0.8em;
            padding-right: 10px;
            box-sizing: border-box;
        }
        
        .no-data {
            color: #95a5a6;
            font-style: italic;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            #fund-data-container {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <h1>基金数据分析展示</h1>
    
    <div id="fund-data-container">
        <!-- 数据将通过JavaScript动态加载 -->
    </div>

    <script>
        async function fetchFundData() {
            try {
                const response = await fetch('/api/fund_data');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const fundData = await response.json();
                return fundData;
            } catch (error) {
                console.error('获取基金数据时出错:', error);
                // 如果API调用失败，使用模拟数据
                return {
  "510300": {
    "基金名称": "华泰博瑞沪深300ETF",
    "风格因子": {
      "市值": {
        "基金值": 98.34,
        "同类平均": 88.13
      },
      "成长": {
        "基金值": 59.26,
        "同类平均": 62.27
      },
      "盈利": {
        "基金值": 71.49,
        "同类平均": 57.59
      },
      "价值": {
        "基金值": 63.49,
        "同类平均": 52.0
      }
    },
    "股票持仓": {
      "重仓股票信息": "重仓股票(前10占比22.5%)",
      "前十大重仓股占比": 22.5
    }
  },
  "512510": {
    "基金名称": "华泰柏瑞中证500ETF",
    "风格因子": {
      "市值": {
        "基金值": 89.62,
        "同类平均": 88.13
      },
      "成长": {
        "基金值": 57.52,
        "同类平均": 62.27
      },
      "盈利": {
        "基金值": 53.8,
        "同类平均": 57.59
      },
      "价值": {
        "基金值": 57.77,
        "同类平均": 52.0
      }
    },
    "股票持仓": {
      "重仓股票信息": "重仓股票(前10占比5.54%)",
      "前十大重仓股占比": 5.54
    }
  },
  "516300": {
    "基金名称": "国泰柏瑞中证1000ETF",
    "风格因子": {
      "市值": {
        "基金值": 75.61,
        "同类平均": 88.13
      },
      "成长": {
        "基金值": 53.32,
        "同类平均": 62.27
      },
      "盈利": {
        "基金值": 48.2,
        "同类平均": 57.59
      },
      "价值": {
        "基金值": 52.14,
        "同类平均": 52.0
      }
    },
    "股票持仓": {
      "重仓股票信息": "重仓股票(前10占比3.13%)",
      "前十大重仓股占比": 3.13
    }
  },
  "563300": {
    "基金名称": "国泰柏瑞中证2000ETF",
    "风格因子": {
      "市值": {
        "基金值": 46.13,
        "同类平均": 88.13
      },
      "成长": {
        "基金值": 52.52,
        "同类平均": 62.27
      },
      "盈利": {
        "基金值": 42.59,
        "同类平均": 57.59
      },
      "价值": {
        "基金值": 46.88,
        "同类平均": 52.0
      }
    },
    "股票持仓": {
      "重仓股票信息": "重仓股票(前10占比3.47%)",
      "前十大重仓股占比": 3.47
    }
  },
  "159907": {
    "基金名称": "广发国证2000ETF",
    "风格因子": {
      "市值": {
        "基金值": 63.7,
        "同类平均": 88.13
      },
      "成长": {
        "基金值": 56.3,
        "同类平均": 62.27
      },
      "盈利": {
        "基金值": 48.95,
        "同类平均": 57.59
      },
      "价值": {
        "基金值": 52.92,
        "同类平均": 52.0
      }
    },
    "股票持仓": null
  }
};
            }
        }
        
        async function renderFundData() {
            const fundData = await fetchFundData();
            const container = document.getElementById('fund-data-container');
            
            // 清空容器
            container.innerHTML = '';
            
            for (const fundCode in fundData) {
                const fund = fundData[fundCode];
                
                // 创建基金容器
                const fundContainer = document.createElement('div');
                fundContainer.className = 'fund-container';
                
                // 基金头部
                const fundHeader = document.createElement('div');
                fundHeader.className = 'fund-header';
                const fundName = fund['基金名称'] || `基金(${fundCode})`;
                fundHeader.textContent = `${fundName} (${fundCode})`;
                fundContainer.appendChild(fundHeader);
                
                // 基金内容
                const fundContent = document.createElement('div');
                fundContent.className = 'fund-content';
                
                // 风格因子部分
                const styleFactorsSection = document.createElement('div');
                styleFactorsSection.className = 'section';
                
                const styleFactorsTitle = document.createElement('div');
                styleFactorsTitle.className = 'section-title';
                styleFactorsTitle.textContent = '风格因子';
                styleFactorsSection.appendChild(styleFactorsTitle);
                
                const styleFactorsGrid = document.createElement('div');
                styleFactorsGrid.className = 'style-factors';
                
                const styleFactors = fund['风格因子'];
                // 修改因子显示顺序：市值、成长、盈利、价值
                const factorOrder = ['市值', '成长', '盈利', '价值'];
                
                for (const factorName of factorOrder) {
                    const factor = styleFactors[factorName];
                    
                    const factorCard = document.createElement('div');
                    factorCard.className = 'factor-card';
                    
                    const factorNameElem = document.createElement('div');
                    factorNameElem.className = 'factor-name';
                    factorNameElem.textContent = factorName;
                    factorCard.appendChild(factorNameElem);
                    
                    const factorValues = document.createElement('div');
                    factorValues.className = 'factor-values';
                    
                    const fundValueElem = document.createElement('div');
                    fundValueElem.className = 'factor-value fund-value';
                    fundValueElem.textContent = `${factor['基金值']}`;
                    factorValues.appendChild(fundValueElem);
                    
                    const averageValueElem = document.createElement('div');
                    averageValueElem.className = 'factor-value average-value';
                    averageValueElem.textContent = `/${factor['同类平均']}`;
                    factorValues.appendChild(averageValueElem);
                    
                    factorCard.appendChild(factorValues);
                    styleFactorsGrid.appendChild(factorCard);
                }
                
                styleFactorsSection.appendChild(styleFactorsGrid);
                fundContent.appendChild(styleFactorsSection);
                
                // 股票持仓部分
                const stockPositionSection = document.createElement('div');
                stockPositionSection.className = 'section';
                
                const stockPositionTitle = document.createElement('div');
                stockPositionTitle.className = 'section-title';
                stockPositionTitle.textContent = '股票持仓';
                stockPositionSection.appendChild(stockPositionTitle);
                
                const stockInfo = document.createElement('div');
                stockInfo.className = 'stock-info';
                
                if (fund['股票持仓']) {
                    const heavyStockText = document.createElement('div');
                    heavyStockText.className = 'heavy-stock-text';
                    heavyStockText.textContent = fund['股票持仓']['重仓股票信息'];
                    stockInfo.appendChild(heavyStockText);
                    
                    const percentageBar = document.createElement('div');
                    percentageBar.className = 'percentage-bar';
                    
                    const percentageFill = document.createElement('div');
                    percentageFill.className = 'percentage-fill';
                    percentageFill.style.width = `${Math.min(fund['股票持仓']['前十大重仓股占比'], 100)}%`;
                    percentageFill.textContent = `${fund['股票持仓']['前十大重仓股占比']}%`;
                    percentageBar.appendChild(percentageFill);
                    
                    stockInfo.appendChild(percentageBar);
                } else {
                    const noData = document.createElement('div');
                    noData.className = 'no-data';
                    noData.textContent = '暂无股票持仓数据';
                    stockInfo.appendChild(noData);
                }
                
                stockPositionSection.appendChild(stockInfo);
                fundContent.appendChild(stockPositionSection);
                
                fundContainer.appendChild(fundContent);
                container.appendChild(fundContainer);
            }
        }
        
        // 页面加载完成后渲染数据
        document.addEventListener('DOMContentLoaded', renderFundData);
    </script>
</body>
</html>